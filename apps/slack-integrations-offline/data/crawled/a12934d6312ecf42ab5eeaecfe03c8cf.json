{
    "id": "a12934d6312ecf42ab5eeaecfe03c8cf",
    "metadata": {
        "id": "a12934d6312ecf42ab5eeaecfe03c8cf",
        "url": "https://docs.zenml.io/concepts/secrets",
        "title": "Secrets | ZenML - Bridging the gap between ML & Ops",
        "properties": {
            "description": "Registering and using secrets.",
            "keywords": null,
            "author": null,
            "og:title": "Secrets | ZenML - Bridging the gap between ML & Ops",
            "og:description": "Registering and using secrets.",
            "og:image": "https://docs.zenml.io/~gitbook/ogimage/64m9yBDU8LRGWBdP7LJT",
            "twitter:card": "summary_large_image",
            "twitter:title": "Secrets | ZenML - Bridging the gap between ML & Ops",
            "twitter:description": "Registering and using secrets.",
            "twitter:image": "https://docs.zenml.io/~gitbook/ogimage/64m9yBDU8LRGWBdP7LJT"
        }
    },
    "content": "`Ctrl``k`\n\nGitBook AssistantAsk\n\nProductResourcesGitHubStart free\n\nMore\n\n  * Documentation\n  * Learn\n  * ZenML Pro\n  * Stacks\n  * API Reference\n  * SDK Reference\n  * Changelog\n\n\n\nGitBook Assistant\n\nGitBook Assistant\n\nWorking...Thinking...\n\nGitBook Assistant\n\n##### Good evening\n\nI'm here to help you with the docs.\n\nWhat is this page about?What should I read next?Can you give an example?\n\n`Ctrl``i`\n\nAI Based on your context\n\nSend\n\n  * Getting Started\n\n    * Welcome to ZenML\n    * Installation\n    * Hello World\n    * Your First AI Pipeline\n    * Core Concepts\n    * System Architecture\n  * Deploying ZenML\n\n    * Deploy\n    * Connect\n    * Manage\n  * Concepts\n\n    * Steps & Pipelines\n    * Artifacts\n    * Stack & Components\n    * Service Connectors\n    * Pipeline Snapshots\n    * Pipeline Deployments\n    * Containerization\n    * Code Repositories\n    * Secrets\n    * Environment Variables\n    * Tags\n    * Metadata\n    * Models\n    * Dashboard\n    * Templates\n  * Reference\n\n    * Community & content\n    * Environment Variables\n    * MCP Docs & llms.txt\n    * FAQ\n    * Global settings\n    * Legacy docs\n\n\n\nPowered by GitBook\n\nOn this page\n\n  * How to create a secret\n  * Set scope for secrets\n  * Accessing registered secrets\n  * Reference secrets in stack component attributes and settings\n  * Fetch secret values in a step\n\n\n\nWas this helpful?\n\nGitBook AssistantAsk\n\n  1. Concepts\n\n\n\n# Secrets\n\nRegistering and using secrets.\n\nZenML secrets are groupings of **key-value pairs** which are securely stored in the ZenML secrets store. Additionally, a secret always has a **name** that allows you to fetch or reference them in your pipelines and stacks. Secrets are essential for both traditional ML workflows (database credentials, model registry access) and AI agent development (LLM API keys, third-party service credentials).\n\n## \n\nHow to create a secret\n\nCLI\n\nPython SDK\n\nTo create a secret with a name `<SECRET_NAME>` and a key-value pair, you can run the following CLI command:\n\nCopy```\nzenmlsecretcreate<SECRET_NAME> \\\n--<KEY_1>=<VALUE_1> \\\n--<KEY_2>=<VALUE_2>\n# Another option is to use the '--values' option and provide key-value pairs in either JSON or YAML format.\nzenmlsecretcreate<SECRET_NAME> \\\n--values='{\"key1\":\"value2\",\"key2\":\"value2\"}'\n# Example: Create secrets for LLM API keys\nzenmlsecretcreateopenai_secret \\\n--api_key=sk-proj-... \\\n--organization_id=org-...\nzenmlsecretcreateanthropic_secret \\\n--api_key=sk-ant-api03-...\n# Example: Create secrets for multi-agent system credentials\nzenmlsecretcreateagent_tools_secret \\\n--google_search_api_key=AIza... \\\n--weather_api_key=abc123 \\\n--database_url=postgresql://user:pass@host/db\n```\n\n\nAlternatively, you can create the secret in an interactive session (in which ZenML will query you for the secret keys and values) by passing the `--interactive/-i` parameter:\n\nCopy```\nzenml secret create <SECRET_NAME> -i\n```\n\n\nFor secret values that are too big to pass as a command line argument, or have special characters, you can also use the special `@` syntax to indicate to ZenML that the value needs to be read from a file:\n\nCopy```\nzenml secret create <SECRET_NAME> \\\n  --key=@path/to/file.txt \\\n  ...\n# Alternatively, you can utilize the '--values' option by specifying a file path containing key-value pairs in either JSON or YAML format.\nzenml secret create <SECRET_NAME> \\\n  --values=@path/to/file.txt\n```\n\n\nThe CLI also includes commands that can be used to list, update and delete secrets. A full guide on using the CLI to create, access, update and delete secrets is available here.\n\n**Interactively register missing secrets for your stack**\n\nIf you're using components with secret references in your stack, you need to make sure that all the referenced secrets exist. To make this process easier, you can use the following CLI command to interactively register all secrets for a stack:\n\nCopy```\nzenml stack register-secrets [<STACK_NAME>]\n```\n\n\nThe ZenML client API offers a programmatic interface to create, e.g.:\n\nCopy```\nfrom zenml.client import Client\nclient = Client()\nclient.create_secret(\n  name=\"my_secret\",\n  values={\n    \"username\": \"admin\",\n    \"password\": \"abc123\"\n  }\n)\n# Example: Create LLM API secrets programmatically\nclient.create_secret(\n  name=\"openai_secret\",\n  values={\n    \"api_key\": \"sk-proj-...\",\n    \"organization_id\": \"org-...\"\n  }\n)\n```\n\n\nOther Client methods used for secrets management include `get_secret` to fetch a secret by name or id, `update_secret` to update an existing secret, `list_secrets` to query the secrets store using a variety of filtering and sorting criteria, and `delete_secret` to delete a secret. The full Client API reference is available here.\n\n## \n\nSet scope for secrets\n\nZenML secrets can be scoped to a user. This allows you to create secrets that are only accessible to one user.\n\nBy default, all created secrets are scoped to the active user. To create a secret and scope it to your active user instead, you can pass the `--scope` argument to the CLI command:\n\nCopy```\nzenml secret create <SECRET_NAME> \\\n  --scope user \\\n  --<KEY_1>=<VALUE_1> \\\n  --<KEY_2>=<VALUE_2>\n```\n\n\nScopes also act as individual namespaces. When you are referencing a secret by name in your pipelines and stacks, ZenML will look for a secret with that name scoped to the active user.\n\n## \n\nAccessing registered secrets\n\n### \n\nReference secrets in stack component attributes and settings\n\nSome of the components in your stack require you to configure them with sensitive information like passwords or tokens, so they can connect to the underlying infrastructure. Secret references allow you to configure these components in a secure way by not specifying the value directly but instead referencing a secret by providing the secret name and key. Referencing a secret for the value of any string attribute of your stack components, simply specify the attribute using the following syntax: `{{<SECRET_NAME>.<SECRET_KEY>}}`\n\nFor example:\n\nCLI\n\nCopy```\n# Register a secret called `mlflow_secret` with key-value pairs for the\n# username and password to authenticate with the MLflow tracking server\n# Using central secrets management\nzenml secret create mlflow_secret \\\n  --username=admin \\\n  --password=abc123\n# Then reference the username and password in our experiment tracker component\nzenml experiment-tracker register mlflow \\\n  --flavor=mlflow \\\n  --tracking_username={{mlflow_secret.username}} \\\n  --tracking_password={{mlflow_secret.password}} \\\n  ...\n```\n\n\nWhen using secret references in your stack, ZenML will validate that all secrets and keys referenced in your stack components exist before running a pipeline. This helps us fail early so your pipeline doesn't fail after running for some time due to some missing secret.\n\nThis validation by default needs to fetch and read every secret to make sure that both the secret and the specified key-value pair exist. This can take quite some time and might fail if you don't have permission to read secrets.\n\nYou can use the environment variable `ZENML_SECRET_VALIDATION_LEVEL` to disable or control the degree to which ZenML validates your secrets:\n\n  * Setting it to `NONE` disables any validation.\n\n  * Setting it to `SECRET_EXISTS` only validates the existence of secrets. This might be useful if the machine you're running on only has permission to list secrets but not actually read their values.\n\n  * Setting it to `SECRET_AND_KEY_EXISTS` (the default) validates both the secret existence as well as the existence of the exact key-value pair.\n\n\n\n\n### \n\nFetch secret values in a step\n\nIf you are using centralized secrets management, you can access secrets directly from within your steps through the ZenML `Client` API. This allows you to use your secrets for querying APIs from within your step without hard-coding your access keys:\n\nCopy```\nfrom zenml import step\nfrom zenml.client import Client\nimport openai\n@step\ndef secret_loader() -> None:\n  \"\"\"Load the example secret from the server.\"\"\"\n  # Fetch the secret from ZenML.\n  secret = Client().get_secret( < SECRET_NAME >)\n  # `secret.secret_values` will contain a dictionary with all key-value\n  # pairs within your secret.\n  authenticate_to_some_api(\n    username=secret.secret_values[\"username\"],\n    password=secret.secret_values[\"password\"],\n  )\n  ...\n@step\ndef run_llm_agent(prompt: str, query: str) -> str:\n  \"\"\"Execute an LLM agent using securely stored API keys.\"\"\"\n  # Fetch LLM API credentials from ZenML secrets\n  openai_secret = Client().get_secret(\"openai_secret\")\n  # Use the API key to initialize the LLM client\n@step\ndef run_llm_agent(prompt: str, query: str) -> str:\n  \"\"\"Execute an LLM agent using securely stored API keys.\"\"\"\n  # Fetch LLM API credentials from ZenML secrets\n  openai_secret = Client().get_secret(\"openai_secret\")\n  # Initialize the OpenAI client with credentials\n  from openai import OpenAI\n  client = OpenAI(\n    api_key=openai_secret.secret_values[\"api_key\"],\n    organization=openai_secret.secret_values[\"organization_id\"]\n  )\n  # Execute the agent\n  response = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[\n      {\"role\": \"system\", \"content\": prompt},\n      {\"role\": \"user\", \"content\": query}\n    ]\n  )\n  return response.choices[0].message.content\n  return response.choices[0].message.content\n```\n\n\nPreviousCode RepositoriesNextEnvironment Variables\n\nLast updated 5 months ago\n\nWas this helpful?\n",
    "summary": null,
    "content_quality_score": null,
    "child_urls": [
        "https://docs.zenml.io/",
        "https://zenml.io",
        "https://zenml.io/slack",
        "https://cloud.zenml.io/signup",
        "https://docs.zenml.io/user-guides",
        "https://docs.zenml.io/pro",
        "https://docs.zenml.io/stacks",
        "https://docs.zenml.io/api-reference",
        "https://docs.zenml.io/sdk-reference",
        "https://docs.zenml.io/changelog",
        "https://docs.zenml.io/getting-started/installation",
        "https://docs.zenml.io/getting-started/hello-world",
        "https://docs.zenml.io/getting-started/your-first-ai-pipeline",
        "https://docs.zenml.io/getting-started/core-concepts",
        "https://docs.zenml.io/getting-started/system-architectures",
        "https://docs.zenml.io/deploying-zenml/deploying-zenml",
        "https://docs.zenml.io/deploying-zenml/connecting-to-zenml",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server",
        "https://docs.zenml.io/concepts/steps_and_pipelines",
        "https://docs.zenml.io/concepts/artifacts",
        "https://docs.zenml.io/concepts/stack_components",
        "https://docs.zenml.io/concepts/service_connectors",
        "https://docs.zenml.io/concepts/snapshots",
        "https://docs.zenml.io/concepts/deployment",
        "https://docs.zenml.io/concepts/containerization",
        "https://docs.zenml.io/concepts/code-repositories",
        "https://docs.zenml.io/concepts/secrets",
        "https://docs.zenml.io/concepts/environment-variables",
        "https://docs.zenml.io/concepts/tags",
        "https://docs.zenml.io/concepts/metadata",
        "https://docs.zenml.io/concepts/models",
        "https://docs.zenml.io/concepts/dashboard-features",
        "https://docs.zenml.io/concepts/templates",
        "https://docs.zenml.io/reference/community-and-content",
        "https://docs.zenml.io/reference/environment-variables",
        "https://docs.zenml.io/reference/llms-txt",
        "https://docs.zenml.io/reference/faq",
        "https://docs.zenml.io/reference/global-settings",
        "https://docs.zenml.io/reference/legacy-docs",
        "https://docs.zenml.io/concepts/secrets#how-to-create-a-secret",
        "https://docs.zenml.io/concepts/secrets#set-scope-for-secrets",
        "https://docs.zenml.io/concepts/secrets#accessing-registered-secrets",
        "https://docs.zenml.io/concepts/secrets#reference-secrets-in-stack-component-attributes-and-settings",
        "https://docs.zenml.io/concepts/secrets#fetch-secret-values-in-a-step",
        "https://docs.zenml.io/concepts",
        "https://sdkdocs.zenml.io/latest/cli.html#zenml.cli--secrets-management",
        "https://sdkdocs.zenml.io/latest/core_code_docs/core-client.html",
        "https://github.com/zenml-io/zenml",
        "https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=5aBlTJNbVDkrxJp7J1J9"
    ]
}