{
    "id": "603fcfd4a3c381c01960fcc90d072bdc",
    "metadata": {
        "id": "603fcfd4a3c381c01960fcc90d072bdc",
        "url": "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty",
        "title": "Migration guide 0.39.1 → 0.41.0 | ZenML - Bridging the gap between ML & Ops",
        "properties": {
            "description": "How to migrate your ZenML pipelines and steps from version <=0.39.1 to 0.41.0.",
            "keywords": null,
            "author": null,
            "og:title": "Migration guide 0.39.1 → 0.41.0 | ZenML - Bridging the gap between ML & Ops",
            "og:description": "How to migrate your ZenML pipelines and steps from version <=0.39.1 to 0.41.0.",
            "og:image": "https://docs.zenml.io/~gitbook/ogimage/UZbKaxA0WZzQI659NQWm",
            "twitter:card": "summary_large_image",
            "twitter:title": "Migration guide 0.39.1 → 0.41.0 | ZenML - Bridging the gap between ML & Ops",
            "twitter:description": "How to migrate your ZenML pipelines and steps from version <=0.39.1 to 0.41.0.",
            "twitter:image": "https://docs.zenml.io/~gitbook/ogimage/UZbKaxA0WZzQI659NQWm"
        }
    },
    "content": "`Ctrl``k`\n\nGitBook AssistantAsk\n\nProductResourcesGitHubStart free\n\nMore\n\n  * Documentation\n  * Learn\n  * ZenML Pro\n  * Stacks\n  * API Reference\n  * SDK Reference\n  * Changelog\n\n\n\nGitBook Assistant\n\nGitBook Assistant\n\nWorking...Thinking...\n\nGitBook Assistant\n\n##### Good evening\n\nI'm here to help you with the docs.\n\nWhat is this page about?What should I read next?Can you give an example?\n\n`Ctrl``i`\n\nAI Based on your context\n\nSend\n\n  * Getting Started\n\n    * Welcome to ZenML\n    * Installation\n    * Hello World\n    * Your First AI Pipeline\n    * Core Concepts\n    * System Architecture\n  * Deploying ZenML\n\n    * Deploy\n    * Connect\n    * Manage\n\n      * Best practices for upgrading\n      * Using ZenML server in production\n      * Troubleshoot your ZenML server\n      * Migration guide\n\n        * Migration guide 0.13.2 → 0.20.0\n        * Migration guide 0.23.0 → 0.30.0\n        * Migration guide 0.39.1 → 0.41.0\n        * Migration guide 0.58.2 → 0.60.0\n\n  * Concepts\n\n    * Steps & Pipelines\n    * Artifacts\n    * Stack & Components\n    * Service Connectors\n    * Pipeline Snapshots\n    * Pipeline Deployments\n    * Containerization\n    * Code Repositories\n    * Secrets\n    * Environment Variables\n    * Tags\n    * Metadata\n    * Models\n    * Dashboard\n    * Templates\n  * Reference\n\n    * Community & content\n    * Environment Variables\n    * MCP Docs & llms.txt\n    * FAQ\n    * Global settings\n    * Legacy docs\n\n\n\nPowered by GitBook\n\nOn this page\n\n  * Overview\n  * Defining steps\n  * Calling a step outside of a pipeline\n  * Defining pipelines\n  * Configuring pipelines\n  * Running pipelines\n  * Scheduling pipelines\n  * Fetching pipelines after execution\n  * Controlling the step execution order\n  * Defining steps with multiple outputs\n  * Accessing run information inside steps\n\n\n\nWas this helpful?\n\nGitBook AssistantAsk\n\n  1. Deploying ZenML\n  2. Manage\n  3. Migration guide\n\n\n\n# Migration guide 0.39.1 → 0.41.0\n\nHow to migrate your ZenML pipelines and steps from version <=0.39.1 to 0.41.0.\n\nZenML versions 0.40.0 to 0.41.0 introduced a new and more flexible syntax to define ZenML steps and pipelines. This page contains code samples that show you how to upgrade your steps and pipelines to the new syntax.\n\nNewer versions of ZenML still work with pipelines and steps defined using the old syntax, but the old syntax is deprecated and will be removed in the future.\n\n## \n\nOverview\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom typing import Optional\nfrom zenml.steps import BaseParameters, Output, StepContext, step\nfrom zenml.pipelines import pipeline\n# Define a Step\nclassMyStepParameters(BaseParameters):\n  param_1:int\n  param_2: Optional[float]=None\n@step\ndefmy_step(\nparams: MyStepParameters,context: StepContext,\n) ->Output(int_output=int, str_output=str):\n  result =int(params.param_1 * (params.param_2 or1))\n  result_uri = context.get_output_artifact_uri()\nreturn result, result_uri\n# Run the Step separately\nmy_step.entrypoint()\n# Define a Pipeline\n@pipeline\ndefmy_pipeline(my_step):\nmy_step()\nstep_instance =my_step(params=MyStepParameters(param_1=17))\npipeline_instance =my_pipeline(my_step=step_instance)\n# Configure and run the Pipeline\npipeline_instance.configure(enable_cache=False)\nschedule =Schedule(...)\npipeline_instance.run(schedule=schedule)\n# Fetch the Pipeline Run\nlast_run = pipeline_instance.get_runs()[0]\nint_output = last_run.get_step[\"my_step\"].outputs[\"int_output\"].read()\n```\n\n\nCopy```\nfrom typing import Annotated, Optional, Tuple\nfrom zenml import get_step_context, pipeline, step\nfrom zenml.client import Client\n# Define a Step\n@step\ndef my_step(\n  param_1: int, param_2: Optional[float] = None\n) -> Tuple[Annotated[int, \"int_output\"], Annotated[str, \"str_output\"]]:\n  result = int(param_1 * (param_2 or 1))\n  result_uri = get_step_context().get_output_artifact_uri()\n  return result, result_uri\n# Run the Step separately\nmy_step()\n# Define a Pipeline\n@pipeline\ndef my_pipeline():\n  my_step(param_1=17)\n# Configure and run the Pipeline\nmy_pipeline = my_pipeline.with_options(enable_cache=False, schedule=schedule)\nmy_pipeline()\n# Fetch the Pipeline Run\nlast_run = my_pipeline.last_run\nint_output = last_run.steps[\"my_step\"].outputs[\"int_output\"].load()\n```\n\n\n## \n\nDefining steps\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom typing import Optional\nfrom zenml.steps import step, BaseParameters\nfrom zenml.pipelines import pipeline\n# Old: Subclass `BaseParameters` to define parameters for a step\nclass MyStepParameters(BaseParameters):\n  param_1: int\n  param_2: Optional[float] = None\n@step\ndef my_step(params: MyStepParameters) -> None:\n  ...\n@pipeline\ndef my_pipeline(my_step):\n  my_step()\nstep_instance = my_step(params=MyStepParameters(param_1=17))\npipeline_instance = my_pipeline(my_step=step_instance)\n```\n\n\nCopy```\n# New: Directly define the parameters as arguments of your step function.\n# In case you still want to group your parameters in a separate class,\n# you can subclass `pydantic.BaseModel` and use that as an argument of your\n# step function\nfrom zenml import pipeline, step\n@step\ndef my_step(param_1: int, param_2: Optional[float] = None) -> None:\n  ...\n@pipeline\ndef my_pipeline():\n  my_step(param_1=17)\n```\n\n\nCheck out this page for more information on how to parameterize your steps.\n\n## \n\nCalling a step outside of a pipeline\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom zenml.steps import step\n@step\ndef my_step() -> None:\n  ...\nmy_step.entrypoint() # Old: Call `step.entrypoint(...)`\n```\n\n\nCopy```\nfrom zenml import step\n@step\ndef my_step() -> None:\n  ...\nmy_step() # New: Call the step directly `step(...)`\n```\n\n\n## \n\nDefining pipelines\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom zenml.pipelines import pipeline\n@pipeline\ndef my_pipeline(my_step): # Old: steps are arguments of the pipeline function\n  my_step()\n```\n\n\nCopy```\nfrom zenml import pipeline, step\n@step\ndef my_step() -> None:\n  ...\n@pipeline\ndef my_pipeline():\n  my_step() # New: The pipeline function calls the step directly\n```\n\n\n## \n\nConfiguring pipelines\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom zenml.pipelines import pipeline\nfrom zenml.steps import step\n@step\ndef my_step() -> None:\n  ...\n@pipeline\ndef my_pipeline(my_step):\n  my_step()\n# Old: Create an instance of the pipeline and then call `pipeline_instance.configure(...)`\npipeline_instance = my_pipeline(my_step=my_step())\npipeline_instance.configure(enable_cache=False)\n```\n\n\nCopy```\nfrom zenml import pipeline, step\n@step\ndef my_step() -> None:\n  ...\n@pipeline\ndef my_pipeline():\n  my_step()\n# New: Call the `with_options(...)` method on the pipeline\nmy_pipeline = my_pipeline.with_options(enable_cache=False)\n```\n\n\n## \n\nRunning pipelines\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom zenml.pipelines import pipeline\nfrom zenml.steps import step\n@step\ndef my_step() -> None:\n  ...\n@pipeline\ndef my_pipeline(my_step):\n  my_step()\n# Old: Create an instance of the pipeline and then call `pipeline_instance.run(...)`\npipeline_instance = my_pipeline(my_step=my_step())\npipeline_instance.run(...)\n```\n\n\nCopy```\nfrom zenml import pipeline, step\n@step\ndef my_step() -> None:\n  ...\n@pipeline\ndef my_pipeline():\n  my_step()\nmy_pipeline() # New: Call the pipeline\n```\n\n\n## \n\nScheduling pipelines\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom zenml.pipelines import pipeline, Schedule\nfrom zenml.steps import step\n@step\ndef my_step() -> None:\n  ...\n@pipeline\ndef my_pipeline(my_step):\n  my_step()\n# Old: Create an instance of the pipeline and then call `pipeline_instance.run(schedule=...)`\nschedule = Schedule(...)\npipeline_instance = my_pipeline(my_step=my_step())\npipeline_instance.run(schedule=schedule)\n```\n\n\nCopy```\nfrom zenml.pipelines import Schedule\nfrom zenml import pipeline, step\n@step\ndef my_step() -> None:\n  ...\n@pipeline\ndef my_pipeline():\n  my_step()\n# New: Set the schedule using the `pipeline.with_options(...)` method and then run it\nschedule = Schedule(...)\nmy_pipeline = my_pipeline.with_options(schedule=schedule)\nmy_pipeline()\n```\n\n\nCheck out this page for more information on how to schedule your pipelines.\n\n## \n\nFetching pipelines after execution\n\nOld Syntax\n\nNew Syntax\n\nCopy```\npipeline: PipelineView = zenml.post_execution.get_pipeline(\"first_pipeline\")\nlast_run: PipelineRunView = pipeline.runs[0]\n# OR: last_run = my_pipeline.get_runs()[0]\nmodel_trainer_step: StepView = last_run.get_step(\"model_trainer\")\nmodel: ArtifactView = model_trainer_step.output\nloaded_model = model.read()\n```\n\n\nCopy```\npipeline: PipelineResponseModel = zenml.client.Client().get_pipeline(\"first_pipeline\")\n# OR: pipeline = pipeline_instance.model\nlast_run: PipelineRunResponseModel = pipeline.last_run \n# OR: last_run = pipeline.runs[0] \n# OR: last_run = pipeline.get_runs(custom_filters)[0] \n# OR: last_run = pipeline.last_successful_run\nmodel_trainer_step: StepRunResponseModel = last_run.steps[\"model_trainer\"]\nmodel: ArtifactResponseModel = model_trainer_step.output\nloaded_model = model.load()\n```\n\n\nCheck out this page for more information on how to programmatically fetch information about previous pipeline runs.\n\n## \n\nControlling the step execution order\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom zenml.pipelines import pipeline\n@pipeline\ndef my_pipeline(step_1, step_2, step_3):\n  step_1()\n  step_2()\n  step_3()\n  step_3.after(step_1) # Old: Use the `step.after(...)` method\n  step_3.after(step_2)\n```\n\n\nCopy```\nfrom zenml import pipeline\n@pipeline\ndef my_pipeline():\n  step_1()\n  step_2()\n  step_3(after=[\"step_1\", \"step_2\"]) # New: Pass the `after` argument when calling a step\n```\n\n\nCheck out this page for more information on how to control the step execution order.\n\n## \n\nDefining steps with multiple outputs\n\nOld Syntax\n\nNew Syntax\n\nCopy```\n# Old: Use the `Output` class\nfrom zenml.steps import step, Output\n@step\ndef my_step() -> Output(int_output=int, str_output=str):\n  ...\n```\n\n\nCopy```\n# New: Use a `Tuple` annotation and optionally assign custom output names\nfrom typing import Annotated\nfrom typing import Tuple\nfrom zenml import step\n# Default output names `output_0`, `output_1`\n@step\ndef my_step() -> Tuple[int, str]:\n  ...\n# Custom output names\n@step\ndef my_step() -> Tuple[\n  Annotated[int, \"int_output\"],\n  Annotated[str, \"str_output\"],\n]:\n  ...\n```\n\n\nCheck out this page for more information on how to annotate your step outputs.\n\n## \n\nAccessing run information inside steps\n\nOld Syntax\n\nNew Syntax\n\nCopy```\nfrom zenml.steps import StepContext, step\nfrom zenml.environment import Environment\n@step\ndef my_step(context: StepContext) -> Any: # Old: `StepContext` class defined as arg\n  env = Environment().step_environment\n  output_uri = context.get_output_artifact_uri()\n  step_name = env.step_name # Old: Run info accessible via `StepEnvironment`\n  ...\n```\n\n\nCopy```\nfrom zenml import get_step_context, step\n@step\ndef my_step() -> Any: # New: StepContext is no longer an argument of the step\n  context = get_step_context()\n  output_uri = context.get_output_artifact_uri()\n  step_name = context.step_name # New: StepContext now has ALL run/step info\n  ...\n```\n\n\nCheck out this page for more information on how to fetch run information inside your steps using `get_step_context()`.\n\nPreviousMigration guide 0.23.0 → 0.30.0NextMigration guide 0.58.2 → 0.60.0\n\nLast updated 5 months ago\n\nWas this helpful?\n",
    "summary": null,
    "content_quality_score": null,
    "child_urls": [
        "https://docs.zenml.io/",
        "https://zenml.io",
        "https://zenml.io/slack",
        "https://cloud.zenml.io/signup",
        "https://docs.zenml.io/user-guides",
        "https://docs.zenml.io/pro",
        "https://docs.zenml.io/stacks",
        "https://docs.zenml.io/api-reference",
        "https://docs.zenml.io/sdk-reference",
        "https://docs.zenml.io/changelog",
        "https://docs.zenml.io/getting-started/installation",
        "https://docs.zenml.io/getting-started/hello-world",
        "https://docs.zenml.io/getting-started/your-first-ai-pipeline",
        "https://docs.zenml.io/getting-started/core-concepts",
        "https://docs.zenml.io/getting-started/system-architectures",
        "https://docs.zenml.io/deploying-zenml/deploying-zenml",
        "https://docs.zenml.io/deploying-zenml/connecting-to-zenml",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/best-practices-upgrading-zenml",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/using-zenml-server-in-prod",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/troubleshoot-your-deployed-server",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-twenty",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-thirty",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-sixty",
        "https://docs.zenml.io/concepts/steps_and_pipelines",
        "https://docs.zenml.io/concepts/artifacts",
        "https://docs.zenml.io/concepts/stack_components",
        "https://docs.zenml.io/concepts/service_connectors",
        "https://docs.zenml.io/concepts/snapshots",
        "https://docs.zenml.io/concepts/deployment",
        "https://docs.zenml.io/concepts/containerization",
        "https://docs.zenml.io/concepts/code-repositories",
        "https://docs.zenml.io/concepts/secrets",
        "https://docs.zenml.io/concepts/environment-variables",
        "https://docs.zenml.io/concepts/tags",
        "https://docs.zenml.io/concepts/metadata",
        "https://docs.zenml.io/concepts/models",
        "https://docs.zenml.io/concepts/dashboard-features",
        "https://docs.zenml.io/concepts/templates",
        "https://docs.zenml.io/reference/community-and-content",
        "https://docs.zenml.io/reference/environment-variables",
        "https://docs.zenml.io/reference/llms-txt",
        "https://docs.zenml.io/reference/faq",
        "https://docs.zenml.io/reference/global-settings",
        "https://docs.zenml.io/reference/legacy-docs",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#overview",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#defining-steps",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#calling-a-step-outside-of-a-pipeline",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#defining-pipelines",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#configuring-pipelines",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#running-pipelines",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#scheduling-pipelines",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#fetching-pipelines-after-execution",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#controlling-the-step-execution-order",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#defining-steps-with-multiple-outputs",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide/migration-zero-forty#accessing-run-information-inside-steps",
        "https://docs.zenml.io/deploying-zenml",
        "https://docs.zenml.io/concepts/steps_and_pipelines#parameters-and-artifacts",
        "https://docs.zenml.io/user-guides/tutorial/managing-scheduled-pipelines",
        "https://docs.zenml.io/how-to/model-management-metrics/track-metrics-metadata/fetch-metadata-within-steps",
        "https://docs.zenml.io/concepts/steps_and_pipelines/advanced_features#step-execution-order",
        "https://docs.zenml.io/concepts/steps_and_pipelines#type-annotations",
        "https://github.com/zenml-io/zenml",
        "https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=5aBlTJNbVDkrxJp7J1J9"
    ]
}